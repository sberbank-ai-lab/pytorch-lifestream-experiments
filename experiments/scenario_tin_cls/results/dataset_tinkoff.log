load_source_data       : Loaded 3951115 rows from "/mnt/data/ovsov/repo/dltranz/data/tinkoff/transactions.csv"
load_source_data       : Loaded 3951115 rows in total
trx_to_features        : Found 46948 unique clients
trx_to_features        : Encoder stat for "transaction_month":
codes | trx_count
                       cnt  % of total
transaction_month                     
[1, 2)             1790768    0.453231
[2, 3)             1664583    0.421294
[3, 4)              495764    0.125474
trx_to_features        : Encoder stat for "transaction_day":
codes | trx_count
                    cnt  % of total
transaction_day                    
[1, 4)           513647    0.130001
[4, 7)           504149    0.127597
[7, 11)          566026    0.143257
[11, 14)         352591    0.089238
[14, 17)         346323    0.087652
[17, 21)         457959    0.115906
[21, 24)         338505    0.085673
[24, 27)         334108    0.084560
[27, 31)         431404    0.109185
[31, 32)         106403    0.026930
trx_to_features        : Encoder stat for "merchant_id":
codes | trx_count
                      cnt  % of total
merchant_id                          
[1, 69410)        2542504    0.643490
[69410, 138820)    490877    0.124238
[138820, 208229)   272317    0.068922
[208229, 277639)   178179    0.045096
[277639, 347048)   138818    0.035134
[347048, 416458)    80679    0.020419
[416458, 485867)    69409    0.017567
[485867, 555277)    69410    0.017567
[555277, 624686)    69409    0.017567
[624686, 664199)    39513    0.010000
trx_to_features        : Encoder stat for "merchant_mcc":
codes | trx_count
                  cnt  % of total
merchant_mcc                     
[1, 12)       3027873    0.766334
[12, 23)       275273    0.069670
[23, 35)       194102    0.049126
[35, 46)       140954    0.035674
[46, 58)       103989    0.026319
[58, 69)        66079    0.016724
[69, 81)        49613    0.012557
[81, 92)        31448    0.007959
[92, 104)       22023    0.005574
[104, 410)      39761    0.010063
trx_to_features        : Encoder stat for "transaction_amt":
codes | trx_count
                     cnt  % of total
transaction_amt                     
[0.0, 0.1)       1751628    0.443325
[0.1, 0.2)             0    0.000000
[0.2, 0.3)             0    0.000000
[0.3, 0.4)             0    0.000000
[0.4, 0.5)       1599419    0.404802
[0.5, 0.6)        500853    0.126762
[0.6, 0.7)         84098    0.021285
[0.7, 0.8)         14096    0.003568
[0.8, 0.9)           997    0.000252
[0.9, 1.0)            23    0.000006
trx_to_features        : Trx count per clients:
len(trx_list) | client_count
              cnt  % of total
trx_count                    
[1, 39)     18328    0.390389
[39, 77)     8572    0.182585
[77, 116)    6646    0.141561
[116, 154)   4914    0.104669
[154, 192)   3306    0.070418
[192, 231)   2267    0.048287
[231, 269)   1298    0.027648
[269, 307)    715    0.015230
[307, 346)    425    0.009053
[346, 805)    477    0.010160
trx_to_features        : Feature collection in progress ...
trx_to_features        : Feature names: ['transaction_month', 'transaction_day', 'transaction_amt', 'merchant_id', 'merchant_mcc']
trx_to_features        : Prepared features for 46948 clients
split_dataset          : Train size: 43304 clients
split_dataset          : Test size: 3644 clients
save_features          : Saved to: "/mnt/data/ovsov/repo/dltranz/data/tinkoff/train_trx.p"
save_features          : Saved to: "/mnt/data/ovsov/repo/dltranz/data/tinkoff/test_trx.p"
